(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const h of e)if(h.type==="childList")for(const a of h.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function i(e){const h={};return e.integrity&&(h.integrity=e.integrity),e.referrerPolicy&&(h.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?h.credentials="include":e.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function s(e){if(e.ep)return;e.ep=!0;const h=i(e);fetch(e.href,h)}})();function o(n,t){return Math.random()*(t-n)+n}function P(n,t){return Math.floor(o(n,t+1))}function w(n,t,i,s){return Math.sqrt((i-n)**2+(s-t)**2)}function y(n,t,i,s,e,h){return w(n,t,s,e)<i+h}function m(n){return n*(Math.PI/180)}function I(n,t=10){const i=[],s=Math.PI*2/t;for(let e=0;e<t;e++){const h=e*s,a=o(.7,1.3),r=n*a;i.push({x:Math.cos(h)*r,y:Math.sin(h)*r})}return i}function S(n){return n[Math.floor(Math.random()*n.length)]}class C{constructor(t,i){this.x=t,this.y=i,this.velocityX=0,this.velocityY=0,this.angle=-90,this.radius=20,this.rotationSpeed=250,this.thrustPower=300,this.friction=.98,this.maxSpeed=400,this.maxHealth=100,this.health=this.maxHealth,this.isThrusting=!1,this.invulnerable=!1,this.invulnerableTimer=0,this.invulnerableDuration=2,this.thrustFlicker=0}update(t,i,s,e){if((i.ArrowLeft||i.KeyA)&&(this.angle-=this.rotationSpeed*t),(i.ArrowRight||i.KeyD)&&(this.angle+=this.rotationSpeed*t),this.isThrusting=i.ArrowUp||i.KeyW,this.isThrusting){const r=m(this.angle);this.velocityX+=Math.cos(r)*this.thrustPower*t,this.velocityY+=Math.sin(r)*this.thrustPower*t}this.velocityX*=this.friction,this.velocityY*=this.friction;const h=Math.sqrt(this.velocityX**2+this.velocityY**2);if(h>this.maxSpeed){const r=this.maxSpeed/h;this.velocityX*=r,this.velocityY*=r}this.x+=this.velocityX*t,this.y+=this.velocityY*t;const a=this.radius;this.x<a&&(this.x=a,this.velocityX*=-.5),this.x>s-a&&(this.x=s-a,this.velocityX*=-.5),this.y<a&&(this.y=a,this.velocityY*=-.5),this.y>e-a&&(this.y=e-a,this.velocityY*=-.5),this.invulnerable&&(this.invulnerableTimer-=t,this.invulnerableTimer<=0&&(this.invulnerable=!1)),this.thrustFlicker+=t*20}takeDamage(t){return this.invulnerable?!1:(this.health-=t,this.invulnerable=!0,this.invulnerableTimer=this.invulnerableDuration,!0)}reset(t,i){this.x=t,this.y=i,this.velocityX=0,this.velocityY=0,this.angle=-90,this.health=this.maxHealth,this.invulnerable=!1,this.invulnerableTimer=0}draw(t){if(t.save(),t.translate(this.x,this.y),t.rotate(m(this.angle+90)),this.invulnerable&&Math.floor(this.invulnerableTimer*10)%2===0&&(t.globalAlpha=.3),this.isThrusting){const s=Math.sin(this.thrustFlicker)*.3+.7,e=15+Math.sin(this.thrustFlicker*2)*8;t.beginPath(),t.moveTo(-8,12),t.lineTo(0,12+e*s),t.lineTo(8,12),t.closePath();const h=t.createLinearGradient(0,12,0,12+e);h.addColorStop(0,"#ff6b35"),h.addColorStop(.5,"#f7c331"),h.addColorStop(1,"rgba(255, 200, 100, 0)"),t.fillStyle=h,t.fill()}t.beginPath(),t.moveTo(0,-this.radius),t.lineTo(-15,this.radius-5),t.lineTo(-5,10),t.lineTo(5,10),t.lineTo(15,this.radius-5),t.closePath();const i=t.createLinearGradient(0,-this.radius,0,this.radius);i.addColorStop(0,"#4ecdc4"),i.addColorStop(1,"#2a9d8f"),t.fillStyle=i,t.fill(),t.strokeStyle="#1a535c",t.lineWidth=2,t.stroke(),t.beginPath(),t.arc(0,-5,5,0,Math.PI*2),t.fillStyle="#e9f5f5",t.fill(),t.strokeStyle="#1a535c",t.lineWidth=1,t.stroke(),t.restore()}}const M={XLARGE:{name:"xlarge",radius:100,minSpeed:30,maxSpeed:60,hp:5,points:200,damage:35,spawns:"LARGE",spawnCount:2},LARGE:{name:"large",radius:50,minSpeed:40,maxSpeed:80,hp:3,points:100,damage:25,spawns:"MEDIUM",spawnCount:2},MEDIUM:{name:"medium",radius:30,minSpeed:60,maxSpeed:120,hp:2,points:50,damage:15,spawns:"SMALL",spawnCount:2},SMALL:{name:"small",radius:15,minSpeed:80,maxSpeed:150,hp:1,points:25,damage:10,spawns:null,spawnCount:0}},k=[{fill:"#6b705c",stroke:"#3a3f35"},{fill:"#a5a58d",stroke:"#6b6b54"},{fill:"#8b8b73",stroke:"#5a5a4a"},{fill:"#7f7f6a",stroke:"#4f4f42"},{fill:"#9a8c73",stroke:"#6a5c43"}];class b{constructor(t,i,s,e=null){this.x=t,this.y=i,this.sizeType=s,this.config=M[s],this.radius=this.config.radius,this.hp=this.config.hp;const h=o(this.config.minSpeed,this.config.maxSpeed),a=o(0,Math.PI*2);e?(this.velocityX=e.x*.5+Math.cos(a)*h,this.velocityY=e.y*.5+Math.sin(a)*h):(this.velocityX=Math.cos(a)*h,this.velocityY=Math.sin(a)*h),this.rotation=o(0,Math.PI*2),this.rotationSpeed=o(-2,2);const r=Math.floor(o(8,12));this.vertices=I(this.radius,r),this.color=S(k),this.destroyed=!1}update(t,i,s){this.x+=this.velocityX*t,this.y+=this.velocityY*t,this.rotation+=this.rotationSpeed*t,this.x-this.radius<0&&(this.x=this.radius,this.velocityX*=-1),this.x+this.radius>i&&(this.x=i-this.radius,this.velocityX*=-1),this.y-this.radius<0&&(this.y=this.radius,this.velocityY*=-1),this.y+this.radius>s&&(this.y=s-this.radius,this.velocityY*=-1)}hit(){return this.hp--,this.hp<=0?(this.destroyed=!0,!0):!1}getFragments(){if(!this.config.spawns)return[];const t=[],i=this.config.spawns;for(let s=0;s<this.config.spawnCount;s++){const e=o(0,Math.PI*2),h=this.radius*.3,a=this.x+Math.cos(e)*h,r=this.y+Math.sin(e)*h;t.push(new b(a,r,i,{x:this.velocityX,y:this.velocityY}))}return t}draw(t){t.save(),t.translate(this.x,this.y),t.rotate(this.rotation),t.beginPath(),t.moveTo(this.vertices[0].x+4,this.vertices[0].y+4);for(let s=1;s<this.vertices.length;s++)t.lineTo(this.vertices[s].x+4,this.vertices[s].y+4);t.closePath(),t.fillStyle="rgba(0, 0, 0, 0.2)",t.fill(),t.beginPath(),t.moveTo(this.vertices[0].x,this.vertices[0].y);for(let s=1;s<this.vertices.length;s++)t.lineTo(this.vertices[s].x,this.vertices[s].y);t.closePath();const i=t.createRadialGradient(-this.radius*.3,-this.radius*.3,0,0,0,this.radius);if(i.addColorStop(0,this.color.fill),i.addColorStop(1,this.color.stroke),t.fillStyle=i,t.fill(),t.strokeStyle=this.color.stroke,t.lineWidth=2,t.stroke(),this.hp<this.config.hp){t.beginPath(),t.moveTo(this.vertices[0].x,this.vertices[0].y);for(let s=1;s<this.vertices.length;s++)t.lineTo(this.vertices[s].x,this.vertices[s].y);t.closePath(),t.fillStyle=`rgba(255, 255, 255, ${.1*(this.config.hp-this.hp)})`,t.fill()}t.restore()}}function A(n,t,i){const s=Math.floor(Math.random()*4),e=M[i];let h,a;switch(s){case 0:h=o(e.radius,n-e.radius),a=e.radius;break;case 1:h=n-e.radius,a=o(e.radius,t-e.radius);break;case 2:h=o(e.radius,n-e.radius),a=t-e.radius;break;case 3:h=e.radius,a=o(e.radius,t-e.radius);break}return new b(h,a,i)}class v{constructor(t,i,s){this.x=t,this.y=i,this.speed=600,this.radius=4;const e=m(s);this.velocityX=Math.cos(e)*this.speed,this.velocityY=Math.sin(e)*this.speed,this.destroyed=!1,this.trail=[],this.maxTrailLength=8}update(t,i,s){this.trail.unshift({x:this.x,y:this.y}),this.trail.length>this.maxTrailLength&&this.trail.pop(),this.x+=this.velocityX*t,this.y+=this.velocityY*t,(this.x<0||this.x>i||this.y<0||this.y>s)&&(this.destroyed=!0)}draw(t){for(let s=0;s<this.trail.length;s++){const e=1-s/this.trail.length,h=this.radius*(1-s/this.trail.length*.5);t.beginPath(),t.arc(this.trail[s].x,this.trail[s].y,h,0,Math.PI*2),t.fillStyle=`rgba(255, 170, 50, ${e*.5})`,t.fill()}const i=t.createRadialGradient(this.x,this.y,0,this.x,this.y,this.radius*3);i.addColorStop(0,"rgba(255, 200, 100, 0.8)"),i.addColorStop(.5,"rgba(255, 150, 50, 0.3)"),i.addColorStop(1,"rgba(255, 100, 50, 0)"),t.beginPath(),t.arc(this.x,this.y,this.radius*3,0,Math.PI*2),t.fillStyle=i,t.fill(),t.beginPath(),t.arc(this.x,this.y,this.radius,0,Math.PI*2),t.fillStyle="#fff5e6",t.fill()}}class p{constructor(t,i,s,e,h,a,r){this.x=t,this.y=i,this.color=s,this.size=e,this.initialSize=e,this.lifetime=r,this.maxLifetime=r,this.velocityX=Math.cos(a)*h,this.velocityY=Math.sin(a)*h,this.friction=.98,this.destroyed=!1}update(t){if(this.lifetime-=t,this.lifetime<=0){this.destroyed=!0;return}this.x+=this.velocityX*t,this.y+=this.velocityY*t,this.velocityX*=this.friction,this.velocityY*=this.friction;const i=this.lifetime/this.maxLifetime;this.size=this.initialSize*i}draw(t){const i=this.lifetime/this.maxLifetime;t.beginPath(),t.arc(this.x,this.y,this.size,0,Math.PI*2),t.fillStyle=this.color.replace("1)",`${i})`),t.fill()}}class E{constructor(t,i,s,e){this.x=t,this.y=i,this.text=s,this.color=e,this.lifetime=1.5,this.maxLifetime=1.5,this.velocityY=-60,this.destroyed=!1}update(t){if(this.lifetime-=t,this.lifetime<=0){this.destroyed=!0;return}this.y+=this.velocityY*t,this.velocityY*=.98}draw(t){const i=this.lifetime/this.maxLifetime,s=.8+i*.4;t.save(),t.translate(this.x,this.y),t.scale(s,s),t.font='bold 20px "Segoe UI", sans-serif',t.textAlign="center",t.textBaseline="middle",t.shadowColor=this.color,t.shadowBlur=10,t.fillStyle=this.color.replace("1)",`${i})`),t.fillText(this.text,0,0),t.strokeStyle=`rgba(255, 255, 255, ${i*.8})`,t.lineWidth=1,t.strokeText(this.text,0,0),t.restore()}}class L{constructor(){this.particles=[],this.floatingTexts=[]}update(t){for(let i=this.particles.length-1;i>=0;i--)this.particles[i].update(t),this.particles[i].destroyed&&this.particles.splice(i,1);for(let i=this.floatingTexts.length-1;i>=0;i--)this.floatingTexts[i].update(t),this.floatingTexts[i].destroyed&&this.floatingTexts.splice(i,1)}draw(t){for(const i of this.particles)i.draw(t);for(const i of this.floatingTexts)i.draw(t)}createExplosion(t,i,s,e=20,h=200,a=5){const r=["rgba(255, 200, 100, 1)","rgba(255, 150, 50, 1)","rgba(255, 100, 30, 1)",s];for(let c=0;c<e;c++){const l=o(0,Math.PI*2),f=o(h*.3,h),d=o(a*.5,a*1.5),g=o(.3,.8),u=S(r);this.particles.push(new p(t,i,u,d,f,l,g))}}createAsteroidExplosion(t,i,s,e){const h=Math.floor(s*1.5),a=s*3,r=s*.15,c=["rgba(107, 112, 92, 1)","rgba(139, 139, 115, 1)","rgba(165, 165, 141, 1)",e];for(let l=0;l<h;l++){const f=o(0,Math.PI*2),d=o(a*.3,a),g=o(r*.5,r*2),u=o(.5,1.2),T=S(c);this.particles.push(new p(t,i,T,g,d,f,u))}for(let l=0;l<h/2;l++){const f=o(0,Math.PI*2),d=o(a*.5,a*1.5),g=o(2,4),u=o(.2,.5);this.particles.push(new p(t,i,"rgba(255, 220, 150, 1)",g,d,f,u))}}createDamageEffect(t,i){const s=["rgba(255, 100, 100, 1)","rgba(255, 150, 100, 1)","rgba(255, 200, 150, 1)"];for(let e=0;e<15;e++){const h=o(0,Math.PI*2),a=o(100,250),r=o(3,8),c=o(.3,.6),l=S(s);this.particles.push(new p(t,i,l,r,a,h,c))}}createThrustParticle(t,i,s){const e=o(-.3,.3),h=o(50,150),a=o(2,5),r=o(.1,.3),c=S(["rgba(255, 150, 50, 1)","rgba(255, 200, 100, 1)","rgba(255, 100, 30, 1)"]);this.particles.push(new p(t,i,c,a,h,s+Math.PI+e,r))}clear(){this.particles=[],this.floatingTexts=[]}createBonusCollectionEffect(t,i,s,e){this.floatingTexts.push(new E(t,i,s,e));const h=10;for(let a=0;a<h;a++){const r=o(0,Math.PI*2),c=o(80,150),l=o(3,6),f=o(.3,.6);this.particles.push(new p(t,i,e,l,c,r,f))}for(let a=0;a<5;a++){const r=o(0,Math.PI*2),c=o(50,100),l=o(4,8),f=o(.15,.3);this.particles.push(new p(t,i,"rgba(255, 255, 255, 1)",l,c,r,f))}}}const R={SCORE:{id:"score",color:"#f7c331",glowColor:"rgba(247, 195, 49, 0.5)",symbol:"★",label:"SCORE"},MULTISHOT:{id:"multishot",color:"#4ecdc4",glowColor:"rgba(78, 205, 196, 0.5)",symbol:"✦",label:"TRIPLE SHOT"}},W={XLARGE:.4,LARGE:.3,MEDIUM:.2,SMALL:.1};class O{constructor(t,i,s){this.x=t,this.y=i,this.type=s,this.config=R[s],this.size=16,this.radius=12,this.lifetime=5,this.maxLifetime=5,this.warningThreshold=2,this.bobOffset=0,this.bobSpeed=3,this.rotation=0,this.rotationSpeed=1.5,s==="SCORE"&&(this.scoreValue=Math.round(P(200,1e3)/50)*50),this.destroyed=!1}update(t){if(this.lifetime-=t,this.lifetime<=0){this.destroyed=!0;return}this.bobOffset=Math.sin(this.bobSpeed*(this.maxLifetime-this.lifetime)*Math.PI)*5,this.rotation+=this.rotationSpeed*t}draw(t){if(this.lifetime<this.warningThreshold&&Math.floor(this.lifetime*10)%2===0)return;t.save(),t.translate(this.x,this.y+this.bobOffset),t.shadowColor=this.config.color,t.shadowBlur=15,t.save(),t.rotate(this.rotation);const i=this.size;t.beginPath(),t.roundRect(-i/2,-i/2,i,i,3);const s=t.createLinearGradient(-i/2,-i/2,i/2,i/2);s.addColorStop(0,this.config.color),s.addColorStop(1,this.darkenColor(this.config.color,.6)),t.fillStyle=s,t.fill(),t.strokeStyle=this.darkenColor(this.config.color,.4),t.lineWidth=2,t.stroke(),t.beginPath(),t.moveTo(-i/2+2,0),t.lineTo(i/2-2,0),t.strokeStyle=this.darkenColor(this.config.color,.5),t.lineWidth=1,t.stroke(),t.beginPath(),t.moveTo(0,-i/2+2),t.lineTo(0,i/2-2),t.stroke(),t.restore(),t.shadowBlur=0,t.font='bold 12px "Segoe UI", sans-serif',t.textAlign="center",t.textBaseline="middle",t.fillStyle="#ffffff",t.fillText(this.config.symbol,0,0),t.restore()}darkenColor(t,i){const s=parseInt(t.slice(1,3),16),e=parseInt(t.slice(3,5),16),h=parseInt(t.slice(5,7),16),a=Math.floor(s*i),r=Math.floor(e*i),c=Math.floor(h*i);return`rgb(${a}, ${r}, ${c})`}}function Y(n){const t=W[n]||0;return Math.random()<t?Math.random()<.5?"SCORE":"MULTISHOT":null}class X{constructor(t,i){this.canvasWidth=t,this.canvasHeight=i,this.spawnFromEdge(),this.hp=2,this.maxHp=2,this.radius=25,this.pointsPerHit=100,this.killBonus=500,this.speed=o(80,120),this.baseAngle=Math.atan2(this.velocityY,this.velocityX),this.zigzagTimer=0,this.zigzagPeriod=1.5,this.zigzagAmplitude=.8,this.avoidanceRadius=150,this.avoidanceStrength=100,this.rotation=0,this.rotationSpeed=2,this.pulseTimer=0,this.hitFlashTimer=0,this.bobOffset=0,this.destroyed=!1}spawnFromEdge(){const t=Math.floor(Math.random()*4),i=this.radius||25;switch(t){case 0:this.x=o(i,this.canvasWidth-i),this.y=-i,this.velocityX=o(-50,50),this.velocityY=o(60,100);break;case 1:this.x=this.canvasWidth+i,this.y=o(i,this.canvasHeight-i),this.velocityX=o(-100,-60),this.velocityY=o(-50,50);break;case 2:this.x=o(i,this.canvasWidth-i),this.y=this.canvasHeight+i,this.velocityX=o(-50,50),this.velocityY=o(-100,-60);break;case 3:this.x=-i,this.y=o(i,this.canvasHeight-i),this.velocityX=o(60,100),this.velocityY=o(-50,50);break}}update(t,i,s){this.zigzagTimer+=t,this.pulseTimer+=t,this.bobOffset=Math.sin(this.pulseTimer*3)*3,this.rotation+=this.rotationSpeed*t,this.hitFlashTimer>0&&(this.hitFlashTimer-=t);const e=Math.sin(this.zigzagTimer*Math.PI*2/this.zigzagPeriod)*this.zigzagAmplitude,h=this.baseAngle+e;let a=Math.cos(h)*this.speed,r=Math.sin(h)*this.speed;const c=w(this.x,this.y,i,s);if(c<this.avoidanceRadius&&c>0){const f=1-c/this.avoidanceRadius,d=Math.atan2(this.y-s,this.x-i);a+=Math.cos(d)*this.avoidanceStrength*f,r+=Math.sin(d)*this.avoidanceStrength*f}this.x+=a*t,this.y+=r*t;const l=this.radius+10;this.x<l&&(this.x=l,this.velocityX*=-1,this.baseAngle=Math.PI-this.baseAngle),this.x>this.canvasWidth-l&&(this.x=this.canvasWidth-l,this.velocityX*=-1,this.baseAngle=Math.PI-this.baseAngle),this.y<l&&(this.y=l,this.velocityY*=-1,this.baseAngle=-this.baseAngle),this.y>this.canvasHeight-l&&(this.y=this.canvasHeight-l,this.velocityY*=-1,this.baseAngle=-this.baseAngle)}hit(){return this.hp--,this.hitFlashTimer=.15,this.hp<=0?(this.destroyed=!0,!0):!1}draw(t){t.save(),t.translate(this.x,this.y+this.bobOffset),this.hitFlashTimer>0&&(t.globalAlpha=.5+Math.sin(this.hitFlashTimer*40)*.5);const i=.5+Math.sin(this.pulseTimer*4)*.3;t.shadowColor="#ff00ff",t.shadowBlur=20*i,t.save(),t.rotate(this.rotation*.1),t.beginPath(),t.ellipse(0,5,25,10,0,0,Math.PI*2);const s=t.createLinearGradient(-25,0,25,10);s.addColorStop(0,"#ff66ff"),s.addColorStop(.5,"#cc00cc"),s.addColorStop(1,"#990099"),t.fillStyle=s,t.fill(),t.strokeStyle="#ff00ff",t.lineWidth=2,t.stroke(),t.beginPath(),t.ellipse(0,0,15,12,0,Math.PI,0);const e=t.createRadialGradient(-5,-5,0,0,0,15);e.addColorStop(0,"rgba(200, 255, 255, 0.9)"),e.addColorStop(.5,"rgba(100, 200, 255, 0.7)"),e.addColorStop(1,"rgba(50, 100, 200, 0.5)"),t.fillStyle=e,t.fill(),t.strokeStyle="#88ffff",t.lineWidth=1,t.stroke(),t.fillStyle="#44ff44",t.beginPath(),t.ellipse(0,-3,6,7,0,0,Math.PI*2),t.fill(),t.fillStyle="#000000",t.beginPath(),t.ellipse(-3,-4,2,3,-.3,0,Math.PI*2),t.fill(),t.beginPath(),t.ellipse(3,-4,2,3,.3,0,Math.PI*2),t.fill(),t.fillStyle="#ffffff",t.beginPath(),t.arc(-2,-5,.8,0,Math.PI*2),t.fill(),t.beginPath(),t.arc(4,-5,.8,0,Math.PI*2),t.fill();const h=6;for(let a=0;a<h;a++){const r=a/h*Math.PI*2+this.pulseTimer*2,c=Math.cos(r)*18,l=8+Math.sin(r)*3;t.beginPath(),t.arc(c,l,3,0,Math.PI*2);const f=Math.sin(this.pulseTimer*8+a)>0;t.fillStyle=f?"#ffff00":"#666600",t.fill()}t.restore(),this.hp<this.maxHp&&(t.strokeStyle="rgba(255, 100, 100, 0.8)",t.lineWidth=2,t.beginPath(),t.moveTo(-10,-5),t.lineTo(-5,0),t.lineTo(-12,5),t.stroke(),t.beginPath(),t.moveTo(8,-3),t.lineTo(12,2),t.stroke()),t.restore()}}class z{constructor(t){this.canvas=t,this.ctx=t.getContext("2d"),this.resize(),window.addEventListener("resize",()=>this.resize()),this.ship=null,this.asteroids=[],this.projectiles=[],this.bonuses=[],this.particles=new L,this.multiShotTimer=0,this.et=null,this.etSpawnTimer=10,this.etSpawnInterval=10,this.etWarningMessage=null,this.etWarningTimer=0,this.keys={},this.setupInput(),this.score=0,this.wave=0,this.gameState="title",this.waveTimer=0,this.wavePauseDuration=2,this.fireRate=8,this.fireCooldown=0,this.shakeAmount=0,this.shakeDuration=0,this.lastTime=0,this.gameLoop=this.gameLoop.bind(this),requestAnimationFrame(this.gameLoop)}resize(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight}setupInput(){window.addEventListener("keydown",t=>{this.keys[t.code]=!0,t.code==="Space"&&this.gameState==="title"&&this.startGame(),t.code==="Space"&&this.gameState==="gameOver"&&this.startGame(),["Space","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t.code)&&t.preventDefault()}),window.addEventListener("keyup",t=>{this.keys[t.code]=!1})}startGame(){this.score=0,this.wave=0,this.ship=new C(this.canvas.width/2,this.canvas.height/2),this.asteroids=[],this.projectiles=[],this.bonuses=[],this.particles.clear(),this.multiShotTimer=0,this.et=null,this.etSpawnTimer=10,this.etWarningMessage=null,this.etWarningTimer=0,this.gameState="playing",this.startNextWave()}startNextWave(){this.wave++,this.asteroids=[];const t=2+this.wave;for(let i=0;i<t;i++){let s="LARGE";this.wave>=3&&Math.random()<.3&&(s="XLARGE"),this.asteroids.push(A(this.canvas.width,this.canvas.height,s))}this.gameState="playing"}shoot(){if(this.fireCooldown>0)return;const t=m(this.ship.angle),i=this.ship.x+Math.cos(t)*this.ship.radius,s=this.ship.y+Math.sin(t)*this.ship.radius;this.multiShotTimer>0?(this.projectiles.push(new v(i,s,this.ship.angle)),this.projectiles.push(new v(i,s,this.ship.angle-30)),this.projectiles.push(new v(i,s,this.ship.angle+30))):this.projectiles.push(new v(i,s,this.ship.angle)),this.fireCooldown=1/this.fireRate}addScreenShake(t,i){this.shakeAmount=Math.max(this.shakeAmount,t),this.shakeDuration=Math.max(this.shakeDuration,i)}spawnET(){this.et=new X(this.canvas.width,this.canvas.height),this.etWarningMessage="ET INCOMING!",this.etWarningTimer=2}update(t){if(this.gameState==="title"||this.gameState==="gameOver"){this.particles.update(t);return}if(this.gameState==="waveComplete"){this.waveTimer-=t,this.waveTimer<=0&&this.startNextWave(),this.particles.update(t);return}if(this.ship.update(t,this.keys,this.canvas.width,this.canvas.height),this.ship.isThrusting&&Math.random()<.5){const i=m(this.ship.angle),s=this.ship.x-Math.cos(i)*15,e=this.ship.y-Math.sin(i)*15;this.particles.createThrustParticle(s,e,i)}this.keys.Space&&this.shoot(),this.fireCooldown=Math.max(0,this.fireCooldown-t);for(let i=this.projectiles.length-1;i>=0;i--)this.projectiles[i].update(t,this.canvas.width,this.canvas.height),this.projectiles[i].destroyed&&this.projectiles.splice(i,1);for(const i of this.asteroids)i.update(t,this.canvas.width,this.canvas.height);for(let i=this.bonuses.length-1;i>=0;i--)this.bonuses[i].update(t),this.bonuses[i].destroyed&&this.bonuses.splice(i,1);this.multiShotTimer>0&&(this.multiShotTimer-=t),this.etWarningTimer>0&&(this.etWarningTimer-=t,this.etWarningTimer<=0&&(this.etWarningMessage=null)),!this.et&&this.etSpawnTimer>0&&(this.etSpawnTimer-=t,this.etSpawnTimer<=0&&this.spawnET()),this.et&&(this.et.update(t,this.ship.x,this.ship.y),this.et.destroyed&&(this.et=null,this.etSpawnTimer=this.etSpawnInterval)),this.particles.update(t),this.shakeDuration>0&&(this.shakeDuration-=t,this.shakeDuration<=0&&(this.shakeAmount=0)),this.checkCollisions(),this.asteroids.length===0&&this.gameState==="playing"&&(this.gameState="waveComplete",this.waveTimer=this.wavePauseDuration,this.score+=this.wave*50,this.et=null,this.etSpawnTimer=this.etSpawnInterval),this.ship.health<=0&&(this.gameState="gameOver",this.particles.createExplosion(this.ship.x,this.ship.y,"rgba(78, 205, 196, 1)",50,300,8),this.addScreenShake(15,.5))}checkCollisions(){for(let t=this.projectiles.length-1;t>=0;t--){const i=this.projectiles[t];for(let s=this.asteroids.length-1;s>=0;s--){const e=this.asteroids[s];if(y(i.x,i.y,i.radius,e.x,e.y,e.radius)){if(i.destroyed=!0,this.particles.createExplosion(i.x,i.y,e.color.fill,5,100,3),e.hit()){this.score+=e.config.points,this.particles.createAsteroidExplosion(e.x,e.y,e.radius,`rgba(${parseInt(e.color.fill.slice(1,3),16)}, ${parseInt(e.color.fill.slice(3,5),16)}, ${parseInt(e.color.fill.slice(5,7),16)}, 1)`),this.addScreenShake(e.radius*.1,.2);const h=Y(e.sizeType);h&&this.bonuses.push(new O(e.x,e.y,h));const a=e.getFragments();this.asteroids.push(...a),this.asteroids.splice(s,1)}break}}}if(this.projectiles=this.projectiles.filter(t=>!t.destroyed),!this.ship.invulnerable){for(const t of this.asteroids)if(y(this.ship.x,this.ship.y,this.ship.radius,t.x,t.y,t.radius)){this.ship.takeDamage(t.config.damage)&&(this.particles.createDamageEffect(this.ship.x,this.ship.y),this.addScreenShake(10,.3));break}}for(let t=this.bonuses.length-1;t>=0;t--){const i=this.bonuses[t];y(this.ship.x,this.ship.y,this.ship.radius,i.x,i.y,i.radius)&&(this.collectBonus(i),this.bonuses.splice(t,1))}if(this.et)for(let t=this.projectiles.length-1;t>=0;t--){const i=this.projectiles[t];if(y(i.x,i.y,i.radius,this.et.x,this.et.y,this.et.radius)){if(i.destroyed=!0,this.score+=this.et.pointsPerHit,this.particles.createExplosion(i.x,i.y,"#ff00ff",8,150,4),this.et.hit()){this.score+=this.et.killBonus;const s=this.multiShotTimer>0;this.multiShotTimer+=10,this.particles.createExplosion(this.et.x,this.et.y,"#ff00ff",30,300,8);const e=s?"TRIPLE SHOT +10s!":"TRIPLE SHOT!";this.particles.createBonusCollectionEffect(this.et.x,this.et.y,e,"rgba(255, 0, 255, 1)"),this.addScreenShake(12,.4),this.et=null,this.etSpawnTimer=this.etSpawnInterval}break}}if(this.et)for(let t=this.asteroids.length-1;t>=0;t--){const i=this.asteroids[t];i.sizeType==="SMALL"&&y(this.et.x,this.et.y,this.et.radius,i.x,i.y,i.radius)&&(this.particles.createExplosion(i.x,i.y,i.color.fill,10,100,3),this.asteroids.splice(t,1))}}collectBonus(t){if(t.config,t.type==="SCORE")this.score+=t.scoreValue,this.particles.createBonusCollectionEffect(t.x,t.y,`+${t.scoreValue}`,"rgba(247, 195, 49, 1)");else if(t.type==="MULTISHOT"){const i=this.multiShotTimer>0;this.multiShotTimer+=5;const s=i?"+5s":"TRIPLE SHOT!";this.particles.createBonusCollectionEffect(t.x,t.y,s,"rgba(78, 205, 196, 1)")}this.addScreenShake(3,.1)}draw(){const t=this.ctx;if(t.save(),this.shakeAmount>0){const i=(Math.random()-.5)*this.shakeAmount*2,s=(Math.random()-.5)*this.shakeAmount*2;t.translate(i,s)}if(this.drawBackground(),this.gameState!=="title"){this.particles.draw(t);for(const i of this.projectiles)i.draw(t);for(const i of this.asteroids)i.draw(t);for(const i of this.bonuses)i.draw(t);this.et&&this.et.draw(t),this.gameState!=="gameOver"&&this.ship.draw(t)}t.restore(),this.drawUI()}drawBackground(){const t=this.ctx,i=t.createLinearGradient(0,0,0,this.canvas.height);i.addColorStop(0,"#0a0a1a"),i.addColorStop(.5,"#0f1629"),i.addColorStop(1,"#0a0a1a"),t.fillStyle=i,t.fillRect(0,0,this.canvas.width,this.canvas.height),t.fillStyle="rgba(255, 255, 255, 0.5)";const s=12345,e=Math.floor(this.canvas.width*this.canvas.height/5e3);for(let h=0;h<e;h++){const a=(s*(h+1)*9301+49297)%233280/233280*this.canvas.width,r=(s*(h+1)*7927+15485)%174720/174720*this.canvas.height,c=(s*(h+1)*3571+8837)%1e4/1e4*2+.5;t.beginPath(),t.arc(a,r,c,0,Math.PI*2),t.fill()}t.strokeStyle="rgba(78, 205, 196, 0.3)",t.lineWidth=2,t.strokeRect(10,10,this.canvas.width-20,this.canvas.height-20)}drawUI(){const t=this.ctx;if(this.gameState==="title"){this.drawTitleScreen();return}this.gameState==="gameOver"&&this.drawGameOverScreen(),this.gameState==="waveComplete"&&this.drawWaveCompleteMessage();const i=30,s=200,e=20,h=this.ship.health/this.ship.maxHealth;t.fillStyle="rgba(0, 0, 0, 0.5)",t.fillRect(i-2,i-2,s+4,e+4),t.fillStyle="#1a1a2e",t.fillRect(i,i,s,e);let a;if(h>.6?a="#4ecdc4":h>.3?a="#f7c331":a="#ff6b6b",t.fillStyle=a,t.fillRect(i,i,s*h,e),t.strokeStyle="#4ecdc4",t.lineWidth=2,t.strokeRect(i,i,s,e),t.fillStyle="#ffffff",t.font='bold 14px "Segoe UI", sans-serif',t.textAlign="center",t.fillText(`${Math.ceil(this.ship.health)} HP`,i+s/2,i+15),t.textAlign="right",t.font='bold 28px "Segoe UI", sans-serif',t.fillStyle="#4ecdc4",t.fillText(`${this.score}`,this.canvas.width-i,i+25),t.font='14px "Segoe UI", sans-serif',t.fillStyle="rgba(255, 255, 255, 0.6)",t.fillText("SCORE",this.canvas.width-i,i+45),t.textAlign="center",t.font='bold 20px "Segoe UI", sans-serif',t.fillStyle="#f7c331",t.fillText(`WAVE ${this.wave}`,this.canvas.width/2,i+20),this.multiShotTimer>0){const l=i,f=i+e+15;t.textAlign="left",t.font='bold 12px "Segoe UI", sans-serif',t.fillStyle="#4ecdc4",t.fillText("TRIPLE SHOT",l,f-3),t.fillStyle="rgba(0, 0, 0, 0.5)",t.fillRect(l-1,f+2,122,10),t.fillStyle="#1a1a2e",t.fillRect(l,f+3,120,8);const d=Math.min(this.multiShotTimer/10,1);t.fillStyle="#4ecdc4",t.fillRect(l,f+3,120*d,8),t.strokeStyle="#4ecdc4",t.lineWidth=1,t.strokeRect(l,f+3,120,8),t.textAlign="right",t.font='10px "Segoe UI", sans-serif',t.fillStyle="rgba(255, 255, 255, 0.7)",t.fillText(`${this.multiShotTimer.toFixed(1)}s`,l+120,f-3)}if(this.etWarningMessage&&this.etWarningTimer>0){const r=this.canvas.width/2,c=100,l=Math.sin(this.etWarningTimer*10)*.3+.7;t.textAlign="center",t.font='bold 36px "Segoe UI", sans-serif',t.shadowColor="#ff00ff",t.shadowBlur=20*l,t.fillStyle=`rgba(255, 0, 255, ${l})`,t.fillText(this.etWarningMessage,r,c),t.shadowBlur=0}}drawTitleScreen(){const t=this.ctx,i=this.canvas.width/2,s=this.canvas.height/2;t.textAlign="center",t.font='bold 72px "Segoe UI", sans-serif',t.shadowColor="#4ecdc4",t.shadowBlur=30,t.fillStyle="#4ecdc4",t.fillText("ASTEROIDS",i,s-50),t.shadowBlur=0,t.font='24px "Segoe UI", sans-serif',t.fillStyle="rgba(255, 255, 255, 0.7)",t.fillText("Modern Edition",i,s),t.font='18px "Segoe UI", sans-serif',t.fillStyle="rgba(255, 255, 255, 0.5)",t.fillText("Press SPACE to start",i,s+80),t.font='14px "Segoe UI", sans-serif',t.fillStyle="rgba(255, 255, 255, 0.4)",t.fillText("A/D or ←/→ to rotate  •  W or ↑ to thrust  •  SPACE to shoot",i,s+150)}drawGameOverScreen(){const t=this.ctx,i=this.canvas.width/2,s=this.canvas.height/2;t.fillStyle="rgba(0, 0, 0, 0.7)",t.fillRect(0,0,this.canvas.width,this.canvas.height),t.textAlign="center",t.font='bold 64px "Segoe UI", sans-serif',t.shadowColor="#ff6b6b",t.shadowBlur=20,t.fillStyle="#ff6b6b",t.fillText("GAME OVER",i,s-40),t.shadowBlur=0,t.font='bold 32px "Segoe UI", sans-serif',t.fillStyle="#4ecdc4",t.fillText(`Final Score: ${this.score}`,i,s+20),t.font='24px "Segoe UI", sans-serif',t.fillStyle="#f7c331",t.fillText(`Wave Reached: ${this.wave}`,i,s+60),t.font='18px "Segoe UI", sans-serif',t.fillStyle="rgba(255, 255, 255, 0.5)",t.fillText("Press SPACE to play again",i,s+120)}drawWaveCompleteMessage(){const t=this.ctx,i=this.canvas.width/2,s=this.canvas.height/2;t.textAlign="center",t.font='bold 48px "Segoe UI", sans-serif',t.shadowColor="#f7c331",t.shadowBlur=20,t.fillStyle="#f7c331",t.fillText(`WAVE ${this.wave} COMPLETE!`,i,s),t.shadowBlur=0,t.font='24px "Segoe UI", sans-serif',t.fillStyle="rgba(255, 255, 255, 0.7)",t.fillText(`Wave Bonus: +${this.wave*50}`,i,s+40)}gameLoop(t){const i=Math.min((t-this.lastTime)/1e3,.1);this.lastTime=t,this.update(i),this.draw(),requestAnimationFrame(this.gameLoop)}}window.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("gameCanvas"),t=document.getElementById("loading");new z(n),setTimeout(()=>{t.classList.add("hidden")},500)});
//# sourceMappingURL=index-CDe87h45.js.map
